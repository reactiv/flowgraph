{
  "workflowId": "materials_rnd_v1",
  "name": "Materials R&D Workflow",
  "description": "Samples, analyses, and hypotheses with lineage and tags. Scientists create samples, run various analyses (PXRD, SEM, TGA, etc.), and link findings to hypotheses.",
  "tags": ["R&D", "Materials", "Science"],
  "nodeTypes": [
    {
      "type": "Sample",
      "displayName": "Sample",
      "titleField": "nickname",
      "subtitleField": "sample_id",
      "fields": [
        {"key": "sample_id", "label": "Sample ID", "kind": "string", "required": true, "unique": true},
        {"key": "nickname", "label": "Nickname", "kind": "string", "required": true},
        {"key": "author", "label": "Author", "kind": "person", "required": true},
        {"key": "date", "label": "Date", "kind": "datetime", "required": true},
        {"key": "sample_type", "label": "Type", "kind": "enum", "values": ["synth", "post_synth", "analysis", "commercial"]},
        {"key": "details", "label": "Details", "kind": "json"},
        {"key": "tags", "label": "Tags", "kind": "tag[]"},
        {"key": "summary", "label": "Summary", "kind": "string"}
      ],
      "states": {
        "enabled": true,
        "initial": "Draft",
        "values": ["Draft", "In Progress", "Complete", "Archived"],
        "transitions": [
          {"from": "Draft", "to": "In Progress"},
          {"from": "In Progress", "to": "Complete"},
          {"from": "In Progress", "to": "Draft"},
          {"from": "Complete", "to": "Archived"},
          {"from": "Complete", "to": "In Progress"}
        ]
      },
      "ui": {
        "defaultViews": ["list", "detail", "graph", "board", "tree", "timeline"],
        "primarySections": ["summary", "relationships", "files", "events"],
        "listColumns": ["sample_id", "nickname", "author", "sample_type", "date"],
        "quickActions": [
          {"type": "suggest", "label": "Suggest Analysis", "targetNodeType": "Analysis", "edgeType": "HAS_ANALYSIS", "direction": "outgoing"},
          {"type": "link", "label": "Link Hypothesis", "targetNodeType": "Hypothesis", "edgeType": "LINKED_TO_HYPOTHESIS", "direction": "outgoing"},
          {"type": "add_field", "label": "Add Tag", "field": "tags"}
        ]
      }
    },
    {
      "type": "Analysis",
      "displayName": "Analysis",
      "titleField": "result_id",
      "subtitleField": "analysis_type",
      "fields": [
        {"key": "result_id", "label": "Result ID", "kind": "string", "required": true, "unique": true},
        {"key": "analysis_type", "label": "Analysis Type", "kind": "enum", "required": true, "values": ["TGA", "PXRD", "SEM", "EDS", "CHN", "DERP", "SCAT", "3FLEX", "ADAPT"]},
        {"key": "author", "label": "Author", "kind": "person", "required": true},
        {"key": "date", "label": "Date", "kind": "datetime", "required": true},
        {"key": "parameters", "label": "Parameters", "kind": "json"},
        {"key": "processed_results", "label": "Processed Results", "kind": "json"},
        {"key": "files", "label": "Files", "kind": "file[]"},
        {"key": "tags", "label": "Tags", "kind": "tag[]"},
        {"key": "summary", "label": "Summary", "kind": "string"}
      ],
      "states": {
        "enabled": true,
        "initial": "Pending",
        "values": ["Pending", "In Progress", "Complete", "Failed", "Archived"],
        "transitions": [
          {"from": "Pending", "to": "In Progress"},
          {"from": "In Progress", "to": "Complete"},
          {"from": "In Progress", "to": "Failed"},
          {"from": "Complete", "to": "Archived"},
          {"from": "Failed", "to": "In Progress"}
        ]
      },
      "ui": {
        "defaultViews": ["list", "detail", "graph", "table", "timeline"],
        "primarySections": ["summary", "parameters", "results", "relationships", "files", "events"],
        "listColumns": ["result_id", "analysis_type", "author", "date"],
        "quickActions": [
          {"type": "link", "label": "Link Hypothesis", "targetNodeType": "Hypothesis", "edgeType": "ANALYSIS_LINKED_TO_HYPOTHESIS", "direction": "outgoing"},
          {"type": "add_field", "label": "Add Tag", "field": "tags"},
          {"type": "add_field", "label": "Upload File", "field": "files"}
        ]
      }
    },
    {
      "type": "Hypothesis",
      "displayName": "Hypothesis",
      "titleField": "nickname",
      "fields": [
        {"key": "nickname", "label": "Title", "kind": "string", "required": true},
        {"key": "author", "label": "Author", "kind": "person", "required": true},
        {"key": "created_date", "label": "Created Date", "kind": "datetime", "required": true},
        {"key": "details", "label": "Details", "kind": "json"},
        {"key": "statements", "label": "Statements", "kind": "json"},
        {"key": "tags", "label": "Tags", "kind": "tag[]"}
      ],
      "states": {
        "enabled": true,
        "initial": "Proposed",
        "values": ["Proposed", "Active", "Validated", "Rejected", "Dismissed"],
        "transitions": [
          {"from": "Proposed", "to": "Active"},
          {"from": "Active", "to": "Validated"},
          {"from": "Active", "to": "Rejected"},
          {"from": "Proposed", "to": "Dismissed"},
          {"from": "Active", "to": "Dismissed"}
        ]
      },
      "ui": {
        "defaultViews": ["list", "detail", "graph", "board", "cards"],
        "primarySections": ["summary", "statements", "relationships", "events"],
        "listColumns": ["nickname", "author", "created_date"],
        "quickActions": [
          {"type": "link", "label": "Link Sample", "targetNodeType": "Sample", "edgeType": "LINKED_TO_HYPOTHESIS", "direction": "incoming"},
          {"type": "link", "label": "Link Analysis", "targetNodeType": "Analysis", "edgeType": "ANALYSIS_LINKED_TO_HYPOTHESIS", "direction": "incoming"},
          {"type": "add_field", "label": "Add Statement", "field": "statements"}
        ]
      }
    },
    {
      "type": "Tag",
      "displayName": "Tag",
      "titleField": "name",
      "fields": [
        {"key": "tag_id", "label": "Tag ID", "kind": "string", "required": true, "unique": true},
        {"key": "name", "label": "Name", "kind": "string", "required": true},
        {"key": "tag_type", "label": "Type", "kind": "enum", "values": ["USER", "SYSTEM"]},
        {"key": "description", "label": "Description", "kind": "string"}
      ],
      "ui": {
        "defaultViews": ["list", "detail", "cards"],
        "primarySections": ["summary", "relationships"],
        "listColumns": ["name", "tag_type", "description"],
        "quickActions": []
      }
    },
    {
      "type": "InstrumentConfig",
      "displayName": "Instrument Configuration",
      "titleField": "name",
      "subtitleField": "instrument_type",
      "fields": [
        {"key": "instrument_id", "label": "Instrument ID", "kind": "string", "required": true, "unique": true},
        {"key": "name", "label": "Name", "kind": "string", "required": true},
        {"key": "instrument_type", "label": "Instrument Type", "kind": "string", "required": true},
        {"key": "version_id", "label": "Version", "kind": "string"},
        {"key": "sop_summary", "label": "SOP Summary", "kind": "string"},
        {"key": "parameters", "label": "Parameters", "kind": "json"}
      ],
      "states": {
        "enabled": true,
        "initial": "Active",
        "values": ["Active", "Deprecated", "Archived"],
        "transitions": [
          {"from": "Active", "to": "Deprecated"},
          {"from": "Deprecated", "to": "Archived"},
          {"from": "Deprecated", "to": "Active"}
        ]
      },
      "ui": {
        "defaultViews": ["list", "detail", "table"],
        "primarySections": ["summary", "parameters", "relationships"],
        "listColumns": ["name", "instrument_type", "version_id"],
        "quickActions": []
      }
    },
    {
      "type": "FamilyTree",
      "displayName": "Family Tree",
      "titleField": "root_sample_id",
      "fields": [
        {"key": "root_sample_id", "label": "Root Sample ID", "kind": "string", "required": true},
        {"key": "data", "label": "Tree Data", "kind": "json"}
      ],
      "ui": {
        "defaultViews": ["detail", "graph"],
        "primarySections": ["summary", "relationships"],
        "listColumns": ["root_sample_id"],
        "quickActions": []
      }
    }
  ],
  "edgeTypes": [
    {
      "type": "HAS_ANALYSIS",
      "displayName": "has analysis",
      "from": "Sample",
      "to": "Analysis",
      "direction": "out"
    },
    {
      "type": "LINKED_TO_HYPOTHESIS",
      "displayName": "linked to hypothesis",
      "from": "Sample",
      "to": "Hypothesis",
      "direction": "out"
    },
    {
      "type": "ANALYSIS_LINKED_TO_HYPOTHESIS",
      "displayName": "linked to hypothesis",
      "from": "Analysis",
      "to": "Hypothesis",
      "direction": "out"
    },
    {
      "type": "TAGGED_WITH",
      "displayName": "tagged with",
      "from": "Sample",
      "to": "Tag",
      "direction": "out"
    },
    {
      "type": "ANALYSIS_TAGGED_WITH",
      "displayName": "tagged with",
      "from": "Analysis",
      "to": "Tag",
      "direction": "out"
    },
    {
      "type": "HYPOTHESIS_TAGGED_WITH",
      "displayName": "tagged with",
      "from": "Hypothesis",
      "to": "Tag",
      "direction": "out"
    },
    {
      "type": "PARENT_OF",
      "displayName": "parent of",
      "from": "Sample",
      "to": "Sample",
      "direction": "out"
    },
    {
      "type": "BELONGS_TO_TREE",
      "displayName": "belongs to tree",
      "from": "Sample",
      "to": "FamilyTree",
      "direction": "out"
    },
    {
      "type": "USES_CONFIG",
      "displayName": "uses configuration",
      "from": "Analysis",
      "to": "InstrumentConfig",
      "direction": "out"
    }
  ],
  "rules": [
    {
      "id": "sample_requires_analysis_before_complete",
      "when": {
        "nodeType": "Sample",
        "transitionTo": "Complete"
      },
      "requireEdges": [
        {"edgeType": "HAS_ANALYSIS", "minCount": 1}
      ],
      "message": "A Sample must have at least 1 Analysis before it can be marked Complete."
    },
    {
      "id": "hypothesis_requires_evidence_for_validation",
      "when": {
        "nodeType": "Hypothesis",
        "transitionTo": "Validated"
      },
      "requireEdges": [
        {"edgeType": "ANALYSIS_LINKED_TO_HYPOTHESIS", "minCount": 1}
      ],
      "message": "A Hypothesis must be linked to at least 1 Analysis before it can be Validated."
    }
  ],
  "viewTemplates": [
    {
      "id": "hypothesis-kanban",
      "name": "Hypothesis Board",
      "description": "Track hypotheses through their lifecycle stages",
      "icon": "columns",
      "rootType": "Hypothesis",
      "edges": [],
      "levels": {
        "Hypothesis": {
          "style": "kanban",
          "styleConfig": {
            "groupByField": "status",
            "columnOrder": ["Proposed", "Active", "Validated", "Rejected", "Dismissed"],
            "columnColors": {
              "Proposed": "#64748b",
              "Active": "#8b5cf6",
              "Validated": "#22c55e",
              "Rejected": "#ef4444",
              "Dismissed": "#475569"
            },
            "allowDrag": true,
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "author",
              "statusField": "status",
              "statusColors": {
                "Proposed": "#64748b",
                "Active": "#8b5cf6",
                "Validated": "#22c55e",
                "Rejected": "#ef4444",
                "Dismissed": "#475569"
              }
            },
            "showCounts": true,
            "showEmptyColumns": true
          }
        }
      }
    },
    {
      "id": "sample-pipeline",
      "name": "Sample Pipeline",
      "description": "Track samples through processing stages",
      "icon": "git-branch",
      "rootType": "Sample",
      "edges": [],
      "levels": {
        "Sample": {
          "style": "kanban",
          "styleConfig": {
            "groupByField": "status",
            "columnOrder": ["Draft", "In Progress", "Complete", "Archived"],
            "columnColors": {
              "Draft": "#64748b",
              "In Progress": "#3b82f6",
              "Complete": "#22c55e",
              "Archived": "#475569"
            },
            "allowDrag": true,
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "sample_id",
              "statusField": "status",
              "bodyFields": ["author", "sample_type"],
              "statusColors": {
                "Draft": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Archived": "#475569"
              }
            },
            "showCounts": true,
            "showEmptyColumns": true
          }
        }
      }
    },
    {
      "id": "analysis-pipeline",
      "name": "Analysis Pipeline",
      "description": "Track analyses through their workflow",
      "icon": "activity",
      "rootType": "Analysis",
      "edges": [],
      "levels": {
        "Analysis": {
          "style": "kanban",
          "styleConfig": {
            "groupByField": "status",
            "columnOrder": ["Pending", "In Progress", "Complete", "Failed", "Archived"],
            "columnColors": {
              "Pending": "#64748b",
              "In Progress": "#3b82f6",
              "Complete": "#22c55e",
              "Failed": "#ef4444",
              "Archived": "#475569"
            },
            "allowDrag": true,
            "cardTemplate": {
              "titleField": "result_id",
              "subtitleField": "analysis_type",
              "statusField": "status",
              "bodyFields": ["author"],
              "statusColors": {
                "Pending": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Failed": "#ef4444",
                "Archived": "#475569"
              }
            },
            "showCounts": true,
            "showEmptyColumns": true
          }
        }
      }
    },
    {
      "id": "sample-lineage",
      "name": "Sample Lineage",
      "description": "View parent-child relationships between samples as a tree",
      "icon": "git-branch",
      "rootType": "Sample",
      "edges": [
        {"edgeType": "PARENT_OF", "direction": "outgoing", "targetType": "Sample"}
      ],
      "levels": {
        "Sample": {
          "style": "tree",
          "styleConfig": {
            "expandable": true,
            "showDepthLines": true,
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "sample_id",
              "statusField": "status",
              "bodyFields": ["author", "sample_type"],
              "statusColors": {
                "Draft": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Archived": "#475569"
              }
            }
          }
        }
      }
    },
    {
      "id": "sample-timeline",
      "name": "Sample Timeline",
      "description": "Timeline view of samples by creation date",
      "icon": "clock",
      "rootType": "Sample",
      "edges": [],
      "levels": {
        "Sample": {
          "style": "timeline",
          "styleConfig": {
            "dateField": "date",
            "granularity": "day",
            "groupByField": "sample_type",
            "showConnectors": true,
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "sample_id",
              "statusField": "status",
              "bodyFields": ["author", "sample_type"],
              "statusColors": {
                "Draft": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Archived": "#475569"
              }
            }
          }
        }
      }
    },
    {
      "id": "analysis-table",
      "name": "Analysis Table",
      "description": "Tabular view of all analyses with sorting and filtering",
      "icon": "table",
      "rootType": "Analysis",
      "edges": [],
      "levels": {
        "Analysis": {
          "style": "table",
          "styleConfig": {
            "columns": ["result_id", "analysis_type", "author", "date", "status"],
            "sortable": true,
            "selectable": true,
            "statusColors": {
              "Pending": "#64748b",
              "In Progress": "#3b82f6",
              "Complete": "#22c55e",
              "Failed": "#ef4444",
              "Archived": "#475569"
            }
          }
        }
      }
    },
    {
      "id": "hypothesis-cards",
      "name": "Hypothesis Gallery",
      "description": "Card grid view of all hypotheses",
      "icon": "grid",
      "rootType": "Hypothesis",
      "edges": [],
      "levels": {
        "Hypothesis": {
          "style": "cards",
          "styleConfig": {
            "layout": "grid",
            "columns": 3,
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "author",
              "statusField": "status",
              "bodyFields": ["created_date"],
              "statusColors": {
                "Proposed": "#64748b",
                "Active": "#8b5cf6",
                "Validated": "#22c55e",
                "Rejected": "#ef4444",
                "Dismissed": "#475569"
              }
            }
          }
        }
      }
    },
    {
      "id": "sample-record",
      "name": "Sample Detail View",
      "description": "Hierarchical detail view of a sample with its analyses, hypotheses, and related items",
      "icon": "file-text",
      "rootType": "Sample",
      "edges": [
        {"edgeType": "HAS_ANALYSIS", "direction": "outgoing", "targetType": "Analysis"},
        {"edgeType": "LINKED_TO_HYPOTHESIS", "direction": "outgoing", "targetType": "Hypothesis"},
        {"edgeType": "TAGGED_WITH", "direction": "outgoing", "targetType": "Tag"},
        {"edgeType": "PARENT_OF", "direction": "outgoing", "targetType": "Sample"}
      ],
      "levels": {
        "Sample": {
          "style": "record",
          "styleConfig": {
            "selectorStyle": "list",
            "showProperties": true,
            "propertiesTitle": "Sample Properties",
            "propertyFields": ["sample_id", "nickname", "author", "date", "sample_type", "status", "summary"],
            "sections": [
              {
                "targetType": "Analysis",
                "title": "Analyses",
                "description": "Laboratory analyses performed on this sample",
                "collapsedByDefault": false,
                "maxItems": 10,
                "emptyMessage": "No analyses have been performed on this sample",
                "allowCreate": true
              },
              {
                "targetType": "Hypothesis",
                "title": "Linked Hypotheses",
                "description": "Scientific hypotheses related to this sample",
                "collapsedByDefault": false,
                "maxItems": 5,
                "emptyMessage": "No hypotheses linked to this sample",
                "allowCreate": true
              },
              {
                "targetType": "Tag",
                "title": "Tags",
                "description": "Classification tags",
                "collapsedByDefault": true,
                "maxItems": 20,
                "emptyMessage": "No tags applied",
                "allowCreate": true
              },
              {
                "targetType": "Sample",
                "title": "Child Samples",
                "description": "Samples derived from this sample",
                "collapsedByDefault": false,
                "maxItems": 10,
                "emptyMessage": "No child samples",
                "allowCreate": true
              }
            ]
          }
        },
        "Analysis": {
          "style": "cards",
          "styleConfig": {
            "layout": "list",
            "cardTemplate": {
              "titleField": "result_id",
              "subtitleField": "analysis_type",
              "statusField": "status",
              "bodyFields": ["author", "date"],
              "statusColors": {
                "Pending": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Failed": "#ef4444",
                "Archived": "#475569"
              }
            }
          }
        },
        "Hypothesis": {
          "style": "cards",
          "styleConfig": {
            "layout": "list",
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "author",
              "statusField": "status",
              "statusColors": {
                "Proposed": "#64748b",
                "Active": "#8b5cf6",
                "Validated": "#22c55e",
                "Rejected": "#ef4444",
                "Dismissed": "#475569"
              }
            }
          }
        },
        "Tag": {
          "style": "cards",
          "styleConfig": {
            "layout": "inline-chips",
            "cardTemplate": {
              "titleField": "name"
            }
          }
        }
      }
    },
    {
      "id": "analysis-timeline",
      "name": "Analysis Timeline",
      "description": "Timeline view of analyses by date",
      "icon": "clock",
      "rootType": "Analysis",
      "edges": [],
      "levels": {
        "Analysis": {
          "style": "timeline",
          "styleConfig": {
            "dateField": "date",
            "granularity": "day",
            "groupByField": "analysis_type",
            "showConnectors": true,
            "cardTemplate": {
              "titleField": "result_id",
              "subtitleField": "analysis_type",
              "statusField": "status",
              "bodyFields": ["author"],
              "statusColors": {
                "Pending": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Failed": "#ef4444",
                "Archived": "#475569"
              }
            }
          }
        }
      }
    },
    {
      "id": "instrument-table",
      "name": "Instrument Configurations",
      "description": "Table view of all instrument configurations",
      "icon": "settings",
      "rootType": "InstrumentConfig",
      "edges": [],
      "levels": {
        "InstrumentConfig": {
          "style": "table",
          "styleConfig": {
            "columns": ["instrument_id", "name", "instrument_type", "version_id", "status"],
            "sortable": true,
            "selectable": true,
            "statusColors": {
              "Active": "#22c55e",
              "Deprecated": "#f59e0b",
              "Archived": "#64748b"
            }
          }
        }
      }
    },
    {
      "id": "tag-cards",
      "name": "Tag Gallery",
      "description": "Card grid view of all tags",
      "icon": "tag",
      "rootType": "Tag",
      "edges": [],
      "levels": {
        "Tag": {
          "style": "cards",
          "styleConfig": {
            "layout": "grid",
            "columns": 4,
            "cardTemplate": {
              "titleField": "name",
              "subtitleField": "tag_type",
              "bodyFields": ["description"]
            }
          }
        }
      }
    },
    {
      "id": "hypothesis-with-evidence",
      "name": "Hypothesis Evidence",
      "description": "Hypotheses with their supporting samples and analyses",
      "icon": "lightbulb",
      "rootType": "Hypothesis",
      "edges": [
        {"edgeType": "LINKED_TO_HYPOTHESIS", "direction": "incoming", "targetType": "Sample"},
        {"edgeType": "ANALYSIS_LINKED_TO_HYPOTHESIS", "direction": "incoming", "targetType": "Analysis"}
      ],
      "levels": {
        "Hypothesis": {
          "style": "record",
          "styleConfig": {
            "selectorStyle": "cards",
            "showProperties": true,
            "propertiesTitle": "Hypothesis Details",
            "propertyFields": ["nickname", "author", "created_date", "status"],
            "sections": [
              {
                "targetType": "Sample",
                "title": "Supporting Samples",
                "description": "Samples that provide evidence for this hypothesis",
                "collapsedByDefault": false,
                "maxItems": 10,
                "emptyMessage": "No samples linked to this hypothesis"
              },
              {
                "targetType": "Analysis",
                "title": "Supporting Analyses",
                "description": "Analyses that provide evidence for this hypothesis",
                "collapsedByDefault": false,
                "maxItems": 10,
                "emptyMessage": "No analyses linked to this hypothesis"
              }
            ]
          }
        },
        "Sample": {
          "style": "cards",
          "styleConfig": {
            "layout": "list",
            "cardTemplate": {
              "titleField": "nickname",
              "subtitleField": "sample_id",
              "statusField": "status",
              "bodyFields": ["author", "sample_type"],
              "statusColors": {
                "Draft": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Archived": "#475569"
              }
            }
          }
        },
        "Analysis": {
          "style": "cards",
          "styleConfig": {
            "layout": "list",
            "cardTemplate": {
              "titleField": "result_id",
              "subtitleField": "analysis_type",
              "statusField": "status",
              "bodyFields": ["author", "date"],
              "statusColors": {
                "Pending": "#64748b",
                "In Progress": "#3b82f6",
                "Complete": "#22c55e",
                "Failed": "#ef4444",
                "Archived": "#475569"
              }
            }
          }
        }
      }
    }
  ]
}
